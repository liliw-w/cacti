[{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"introduction","dir":"Articles","previous_headings":"","what":"1. Introduction","title":"CACTI peak-window pipeline","text":"cacti package implements CACTI peak-window method chromatin QTL mapping. designed : group nearby peaks non-overlapping windows, residualize peak intensities respect covariates, test association genetic variants multi-peak windows using principal-component omnibus (PCO) test, optionally aggregate per-chromosome results compute window-level FDR. main user-facing functions vignette : cacti_run_chr() – run full CACTI peak-window pipeline one chromosome, cacti_run_genome() – run pipeline across multiple chromosomes add FDR. vignette explains: overall workflow. expected input file formats. output files produced pipeline. Example usage bundled toy data inst/extdata/.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"overview-of-the-peak-window-pipeline","dir":"Articles","previous_headings":"","what":"2. Overview of the peak-window pipeline","title":"CACTI peak-window pipeline","text":"CACTI peak-window pipeline three main steps: Using genomic coordinates (chromosome, start, end) peaks, Divide genome fixed-size windows (e.g. 50 kb), Assign peaks windows create window (group) table. Input: peak intensity matrix (features x samples) covariate matrix (covariates x samples), Fit linear models peak ~ covariates, Save residualized intensity values format original matrix, one inputs association test. Input: cis-QTL summary statistics z peak–SNP pairs, peak windows, residualized phenotype, construct Z-score matrix (variants x peaks), compute PCO-based multi-peak p-value number peaks ≥ min_peaks, otherwise fall back univariate p-value, Output: one p-value file per chromosome, one row per (group, snp) pair. Across chromosomes, cacti_add_fdr() (used cacti_run_genome()) aggregates p-values computes q-values top hit per window.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"input-file-formats","dir":"Articles","previous_headings":"","what":"3. Input file formats","title":"CACTI peak-window pipeline","text":"section describes expected columns layout input file type. also inspect toy dataset bundled package :","code":"inst/extdata/   test_pheno_meta.bed   test_pheno.txt   test_covariates.txt   test_qtl_sum_stats_chr5.txt.gz"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"peak-metadata-pheno-meta-bed-like","dir":"Articles","previous_headings":"3. Input file formats","what":"3.1 Peak metadata (pheno meta / BED-like)","title":"CACTI peak-window pipeline","text":"peak metadata file describes genomic coordinates IDs peaks. Used : cacti_group_peak_window(), cacti_run_chr(), cacti_run_genome() Argument: file_pheno_meta Example file: test_pheno_meta.bed Required columns: phe_chr – chromosome name, typically \"chr\" prefix (e.g. \"chr5\"), phe_from – peak start position (integer; must < phe_to), phe_to – peak end position (integer), phe_id – unique peak identifier.","code":"library(cacti)  file_pheno_meta <- system.file(   \"extdata\", \"test_pheno_meta.bed\",   package = \"cacti\" )  head(data.table::fread(file_pheno_meta)) #>                phe_id phe_chr phe_from phe_to #>                <char>  <char>    <int>  <int> #> 1:   chr5_11429_11873    chr5    11429  11873 #> 2: chr5_217285_220962    chr5   217285 220962 #> 3: chr5_223012_223844    chr5   223012 223844 #> 4: chr5_270610_273325    chr5   270610 273325 #> 5: chr5_320783_323201    chr5   320783 323201 #> 6: chr5_343419_345060    chr5   343419 345060"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"phenotype-matrix-peak-intensity","dir":"Articles","previous_headings":"3. Input file formats","what":"3.2 Phenotype matrix (peak intensity)","title":"CACTI peak-window pipeline","text":"phenotype matrix contains peak intensities (quantitative trait values). Used : cacti_pheno_cov_residual(), cacti_run_chr(), cacti_run_genome() Argument: file_pheno Example file: test_pheno.txt Layout: Rows = features (peaks). First column = feature ID (matching phe_id metadata). Remaining columns = samples.","code":"file_pheno <- system.file(   \"extdata\", \"test_pheno.txt\",   package = \"cacti\" )  head(data.table::fread(file_pheno))[, 1:5] #>                        ID       AF04      AF06       AF08      AF12 #>                    <char>      <num>     <num>      <num>     <num> #> 1: chr5_10248638_10251938  6.1639272 6.5171965  6.0122366 6.0046710 #> 2: chr5_10264481_10265888  0.2981699 0.2977740  2.0098907 0.4789852 #> 3: chr5_10265755_10268539  1.6214124 2.1306168  3.1048357 0.7830301 #> 4: chr5_10307340_10308285  0.7222144 0.8835924  0.2871122 0.5861384 #> 5: chr5_10311409_10312352  0.0350794 1.3397306 -0.2311209 0.3488682 #> 6: chr5_10333519_10334110 -0.1660226 0.8808080  0.5575939 1.1806155"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"covariate-matrix","dir":"Articles","previous_headings":"3. Input file formats","what":"3.3 Covariate matrix","title":"CACTI peak-window pipeline","text":"covariate matrix encodes covariates sample (e.g. PCs, batch, sex, etc.). Used : cacti_pheno_cov_residual(), cacti_run_chr(), cacti_run_genome() Argument: file_cov Example file: test_covariates.txt Layout: Rows = covariates. First column = covariate ID. Remaining columns = samples.","code":"file_cov <- system.file(   \"extdata\", \"test_covariates.txt\",   package = \"cacti\" )  head(data.table::fread(file_cov))[, 1:5] #>        ID       AF04       AF06       AF08       AF12 #>    <char>      <num>      <num>      <num>      <num> #> 1:   cov1 -0.1696051 -0.2304933 -0.2132352 -0.2220646"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"qtl-summary-statistics","dir":"Articles","previous_headings":"3. Input file formats","what":"3.4 QTL summary statistics","title":"CACTI peak-window pipeline","text":"cis-QTL summary stats file contains association summary statistics peak–SNP pairs. Used : cacti_cal_p(), cacti_run_chr(), cacti_run_genome() Argument: qtl_file (per chromosome) qtl_files (multiple chromosomes, given vector/template) Example file: test_qtl_sum_stats_chr5.txt.gz Required columns: phe_id – peak ID (matching phe_id metadata ID phenotype matrix), var_id – variant ID, z – z-score association variant peak.","code":"qtl_file <- system.file(   \"extdata\", \"test_qtl_sum_stats_chr5.txt.gz\",   package = \"cacti\" )  head(data.table::fread(qtl_file)) #>              phe_id      var_id         z #>              <char>      <char>     <num> #> 1: chr5_11429_11873 5_12041_T_A 0.2715305 #> 2: chr5_11429_11873 5_12114_G_C 0.1525914 #> 3: chr5_11429_11873 5_12225_A_G 1.0831622 #> 4: chr5_11429_11873 5_13018_A_C 0.9401877 #> 5: chr5_11429_11873 5_13114_C_G 0.9401877 #> 6: chr5_11429_11873 5_13125_T_G 0.9401877"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"output-files-from-cacti_run_chr","dir":"Articles","previous_headings":"","what":"4. Output files from cacti_run_chr()","title":"CACTI peak-window pipeline","text":"cacti_run_chr() main function running CACTI peak-window pipeline single chromosome.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"overview","dir":"Articles","previous_headings":"4. Output files from cacti_run_chr()","what":"4.1 Overview","title":"CACTI peak-window pipeline","text":"Calling: : Construct peak windows chromosomes (using window_size). Residualize phenotype matrix. Run CACTI association test specified chromosome (chr). returns named list output paths, writes following files:","code":"res_single_chr <- cacti_run_chr(   window_size     = \"50kb\",   file_pheno_meta = <peak metadata>,   file_pheno      = <phenotype matrix>,   file_cov        = <covariate matrix>,   chr             = \"chr5\",   qtl_file        = <QTL summary stats for chr5>,   out_prefix      = <output prefix>,   min_peaks       = 2 )"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"window-level-grouping-file","dir":"Articles","previous_headings":"4. Output files from cacti_run_chr()","what":"4.2 Window-level grouping file","title":"CACTI peak-window pipeline","text":"Path: res_single_chr$file_peak_group Produced : cacti_group_peak_window() Columns: group – window (group) ID (e.g. \"G1\", \"G2\", …), group_chr – chromosome window, group_from – window start position, group_to – window end position, pid_group – semicolon-separated list peak IDs window, n_pid_group – number peaks window.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"peak-level-grouping-file","dir":"Articles","previous_headings":"4. Output files from cacti_run_chr()","what":"4.3 Peak-level grouping file","title":"CACTI peak-window pipeline","text":"Path: res_single_chr$file_peak_group_peaklevel Columns: phe_id – peak ID, phe_chr – chromosome, phe_from, phe_to – peak start/end, group – window ID peak belongs, n_pid_group – number peaks window.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"residualized-phenotype-matrix","dir":"Articles","previous_headings":"4. Output files from cacti_run_chr()","what":"4.4 Residualized phenotype matrix","title":"CACTI peak-window pipeline","text":"Path: res_single_chr$file_pheno_cov_residual layout input phenotype matrix: Rows = features (peak IDs), First column = ID (peak IDs), Remaining columns = residualized values sample.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"per-window-p-value-file-for-the-chromosome","dir":"Articles","previous_headings":"4. Output files from cacti_run_chr()","what":"4.5 Per-window p-value file for the chromosome","title":"CACTI peak-window pipeline","text":"Path: res_single_chr$file_p_peak_group row corresponds (group, snp) pair: group – window ID, snp – variant ID, windows ≥ min_peaks peaks, PCO-based multi-peak p-value. single-peak windows, univariate p-value derived z.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"per-chromosome-example-cacti_run_chr","dir":"Articles","previous_headings":"","what":"5. Per-chromosome example: cacti_run_chr()","title":"CACTI peak-window pipeline","text":"example running full pipeline toy chr5 data included inst/extdata/.","code":"library(cacti)  file_pheno_meta <- system.file(   \"extdata\", \"test_pheno_meta.bed\",   package = \"cacti\" )  file_pheno <- system.file(   \"extdata\", \"test_pheno.txt\",   package = \"cacti\" )  file_cov <- system.file(   \"extdata\", \"test_covariates.txt\",   package = \"cacti\" )  qtl_file <- system.file(   \"extdata\", \"test_qtl_sum_stats_chr5.txt.gz\",   package = \"cacti\" )  # Use a temporary prefix to avoid cluttering the working directory out_prefix <- tempfile(\"cacti_chr5_\")  res_single_chr <- cacti_run_chr(   window_size     = \"50kb\",   file_pheno_meta = file_pheno_meta,   file_pheno      = file_pheno,   file_cov        = file_cov,   chr             = \"chr5\",   qtl_file        = qtl_file,   out_prefix      = out_prefix,   min_peaks       = 2 ) #> [1/3] Group peaks into non-overlapping windows … #> [2/3] Residualize phenotype by covariates … #> [3/3] Run pvalue for chr5 … #>  #>  CACTI peak-window pipeline for chr5 completed successfully! #> Run summary: #> Chromosome:chr5 #> Window size:50kb #>  #> Input files: #> Peaks BED:/tmp/RtmpIvhooj/temp_libpathfd7a43f04ed54/cacti/extdata/test_pheno_meta.bed #> Phenotype:/tmp/RtmpIvhooj/temp_libpathfd7a43f04ed54/cacti/extdata/test_pheno.txt #> Covariate:/tmp/RtmpIvhooj/temp_libpathfd7a43f04ed54/cacti/extdata/test_covariates.txt #> QTL summary stats:/tmp/RtmpIvhooj/temp_libpathfd7a43f04ed54/cacti/extdata/test_qtl_sum_stats_chr5.txt.gz #>  #> Output files: #> Grouped peak: /tmp/Rtmpldbpiw/cacti_chr5_fe8494aa45928_peak_group_window50kb.txt #> Grouped peak (peak as row):/tmp/Rtmpldbpiw/cacti_chr5_fe8494aa45928_peak_group_window50kb_peak_as_row.txt #> Residual phenotype:/tmp/Rtmpldbpiw/cacti_chr5_fe8494aa45928_pheno_cov_residual.txt #> Pval results (chr5): /tmp/Rtmpldbpiw/cacti_chr5_fe8494aa45928_pval_window50kb_chr5.txt.gz  res_single_chr #> $file_peak_group #> [1] \"/tmp/Rtmpldbpiw/cacti_chr5_fe8494aa45928_peak_group_window50kb.txt\" #>  #> $file_peak_group_peaklevel #> [1] \"/tmp/Rtmpldbpiw/cacti_chr5_fe8494aa45928_peak_group_window50kb_peak_as_row.txt\" #>  #> $file_pheno_cov_residual #> [1] \"/tmp/Rtmpldbpiw/cacti_chr5_fe8494aa45928_pheno_cov_residual.txt\" #>  #> $file_p_peak_group #> [1] \"/tmp/Rtmpldbpiw/cacti_chr5_fe8494aa45928_pval_window50kb_chr5.txt.gz\""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"genome-wide-wrapper-cacti_run_genome","dir":"Articles","previous_headings":"","what":"6. Genome-wide wrapper: cacti_run_genome()","title":"CACTI peak-window pipeline","text":"cacti_run_genome() provides convenience wrapper running pipeline across multiple chromosomes, aggregating p-values adding FDR via cacti_add_fdr(). Conceptually, : Loops chrs calls cacti_run_chr() one. Collects per-chromosome p-value files. Calls cacti_add_fdr() compute window-level q-values across windows chromosomes. simplest usage one QTL file per chromosome pass either: character vector qtl_files one path per chromosome, template \"{chr}\" placeholder, e.g. \"extdata/test_qtl_sum_stats_{chr}.txt.gz\". toy example, use data chr5, still demonstrates call function.","code":"file_pheno_meta <- system.file(   \"extdata\", \"test_pheno_meta.bed\",   package = \"cacti\" )  file_pheno <- system.file(   \"extdata\", \"test_pheno.txt\",   package = \"cacti\" )  file_cov <- system.file(   \"extdata\", \"test_covariates.txt\",   package = \"cacti\" )  qtl_file <- system.file(   \"extdata\", \"test_qtl_sum_stats_chr5.txt.gz\",   package = \"cacti\" )  out_prefix <- tempfile(\"cacti_genome_\")  res_genome <- cacti_run_genome(   window_size     = \"50kb\",   file_pheno_meta = file_pheno_meta,   file_pheno      = file_pheno,   file_cov        = file_cov,   chrs            = \"chr5\",                 # toy example: one chromosome   qtl_files       = qtl_file,   out_prefix      = out_prefix,   file_fdr_out    = file.path(tempdir(), \"cacti_fdr_chr5.txt.gz\") ) #> === [I/III] Running CACTI peak-window pipeline genome-wide === #> [1/3] Group peaks into non-overlapping windows … #> [2/3] Residualize phenotype by covariates … #> [3/3] Run pvalue for chr5 … #>  #>  CACTI peak-window pipeline for chr5 completed successfully! #>  #> Input files: #> Peaks BED:/tmp/RtmpIvhooj/temp_libpathfd7a43f04ed54/cacti/extdata/test_pheno_meta.bed #> Phenotype:/tmp/RtmpIvhooj/temp_libpathfd7a43f04ed54/cacti/extdata/test_pheno.txt #> Covariate:/tmp/RtmpIvhooj/temp_libpathfd7a43f04ed54/cacti/extdata/test_covariates.txt #> QTL summary stats:/tmp/RtmpIvhooj/temp_libpathfd7a43f04ed54/cacti/extdata/test_qtl_sum_stats_chr5.txt.gz #>  #> Output files: #> Grouped peak: /tmp/Rtmpldbpiw/cacti_genome_fe8497e195629_peak_group_window50kb.txt #> Grouped peak (peak as row):/tmp/Rtmpldbpiw/cacti_genome_fe8497e195629_peak_group_window50kb_peak_as_row.txt #> Residual phenotype:/tmp/Rtmpldbpiw/cacti_genome_fe8497e195629_pheno_cov_residual.txt #> Pval results (chr5): /tmp/Rtmpldbpiw/cacti_genome_fe8497e195629_pval_window50kb_chr5.txt.gz #>  #> === [II/III] Adding FDR across windows and chromosomes === #>  #> === [III/III] Genome-wide CACTI peak-window pipeline completed with FDR! === #> Run summary: #> Pvalue output: /tmp/Rtmpldbpiw/cacti_genome_fe8497e195629_pval_window50kb_chr5.txt.gz #> FDR output: /tmp/Rtmpldbpiw/cacti_fdr_chr5.txt.gz  res_genome #> $file_peak_group #> [1] \"/tmp/Rtmpldbpiw/cacti_genome_fe8497e195629_peak_group_window50kb.txt\" #>  #> $file_peak_group_peaklevel #> [1] \"/tmp/Rtmpldbpiw/cacti_genome_fe8497e195629_peak_group_window50kb_peak_as_row.txt\" #>  #> $file_pheno_cov_residual #> [1] \"/tmp/Rtmpldbpiw/cacti_genome_fe8497e195629_pheno_cov_residual.txt\" #>  #> $file_p_peak_group #> [1] \"/tmp/Rtmpldbpiw/cacti_genome_fe8497e195629_pval_window50kb_chr5.txt.gz\" #>  #> $file_fdr_out #> [1] \"/tmp/Rtmpldbpiw/cacti_fdr_chr5.txt.gz\""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"summary","dir":"Articles","previous_headings":"","what":"7. Summary","title":"CACTI peak-window pipeline","text":"vignette, : described CACTI peak-window pipeline, documented expected input file formats peak metadata, phenotypes, covariates, QTL summary statistics, explained main output files produced cacti_run_chr(), demonstrated run pipeline per-chromosome genome-wide using bundled toy data inst/extdata/. details step, see function reference: ?cacti_group_peak_window ?cacti_pheno_cov_residual ?cacti_cal_p ?cacti_add_fdr ?cacti_run_chr ?cacti_run_genome","code":""},{"path":"https://liliw-w.github.io/cacti/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Lili Wang. Author, maintainer.","code":""},{"path":"https://liliw-w.github.io/cacti/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wang L (2025). cacti: CACTI: Chromatin QTL Mapping Peak Windows. R package version 0.0.0.9000, https://liliw-w.github.io/cacti, https://github.com/liliw-w/cacti.","code":"@Manual{,   title = {cacti: CACTI: Chromatin QTL Mapping with Peak Windows},   author = {Lili Wang},   year = {2025},   note = {R package version 0.0.0.9000, https://liliw-w.github.io/cacti},   url = {https://github.com/liliw-w/cacti}, }"},{"path":"https://liliw-w.github.io/cacti/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"CACTI overview CACTI (ChromAtin quantitative loCi mulTIple peaks) implements peak-window version CACTI method chromatin QTL mapping. package provides pipeline : group nearby peaks non-overlapping windows fixed genomic size, residualize peak intensities respect covariates, run multi-peak association tests using principal-component omnibus (PCO) test, aggregate results across chromosomes compute window-level FDR.","code":""},{"path":"https://liliw-w.github.io/cacti/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"installation:","code":"install.packages(\"devtools\")   # if not installed yet devtools::install_github(\"liliw-w/cacti\", build_vignettes = TRUE) library(cacti)"},{"path":"https://liliw-w.github.io/cacti/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"installing package, see: vignette “CACTI peak-window pipeline” gives detailed walk inputs, outputs, example usage. Main functions documentation -","code":"vignette(\"cacti_peak_window\", package = \"cacti\") ?cacti ?cacti_run_chr ?cacti_run_genome ?cacti_add_fdr"},{"path":"https://liliw-w.github.io/cacti/index.html","id":"bundled-example-data","dir":"","previous_headings":"","what":"Bundled example data","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"package includes small toy dataset derived Aracena et al. demonstrate pipeline: can access files using system.file():","code":"inst/extdata/   test_pheno_meta.bed   test_pheno.txt   test_covariates.txt   test_qtl_sum_stats_chr5.txt.gz file_pheno_meta <- system.file(\"extdata\", \"test_pheno_meta.bed\", package = \"cacti\")  file_pheno <- system.file(\"extdata\", \"test_pheno.txt\", package = \"cacti\")  file_cov <- system.file(\"extdata\", \"test_covariates.txt\", package = \"cacti\")  qtl_file <- system.file(\"extdata\", \"test_qtl_sum_stats_chr5.txt.gz\", package = \"cacti\")"},{"path":[]},{"path":"https://liliw-w.github.io/cacti/index.html","id":"peak-metadata-file_pheno_meta","dir":"","previous_headings":"Input file formats","what":"Peak metadata (file_pheno_meta)","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"BED-like table describing peaks: Example: test_pheno_meta.bed phe_chr: chromosome (e.g. \"chr5\") phe_from: peak start (integer, < phe_to) phe_to: peak end (integer) phe_id: peak identifier (unique)","code":""},{"path":"https://liliw-w.github.io/cacti/index.html","id":"phenotype-matrix-file_pheno","dir":"","previous_headings":"Input file formats","what":"Phenotype matrix (file_pheno)","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"Peak intensity matrix: Example: test_pheno.txt Rows = features (peaks) First column = feature ID (matching phe_id) Remaining columns = samples","code":""},{"path":"https://liliw-w.github.io/cacti/index.html","id":"covariate-matrix-file_cov","dir":"","previous_headings":"Input file formats","what":"Covariate matrix (file_cov)","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"Covariates per sample: Example: test_covariates.txt Rows = covariates First column = covariate ID Remaining columns = samples","code":""},{"path":"https://liliw-w.github.io/cacti/index.html","id":"qtl-summary-statistics-qtl_file","dir":"","previous_headings":"Input file formats","what":"QTL summary statistics (qtl_file)","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"cis-QTL summary statistics per chromosome: Example: test_qtl_sum_stats_chr5.txt.gz phe_id: peak ID (matching phenotype metadata) var_id: variant ID z: z-score peak–SNP association","code":""},{"path":"https://liliw-w.github.io/cacti/index.html","id":"quick-start-single-chromosome-pipeline-cacti_run_chr","dir":"","previous_headings":"","what":"Quick start: single-chromosome pipeline (cacti_run_chr())","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"cacti_run_chr() runs full peak-window pipeline one chromosome: : Group peaks non-overlapping windows (50 kb). Residualize phenotype matrix respect covariates. Run CACTI association tests chr5. res_single_chr list containing paths : file_peak_group – window-level group table file_peak_group_peaklevel – peak-level group assignment file_pheno_cov_residual – residualized phenotype matrix file_p_peak_group – window-level p-values chr5","code":"out_prefix <- tempfile(\"cacti_chr5_\")  res_single_chr <- cacti_run_chr(   window_size     = \"50kb\",   file_pheno_meta = file_pheno_meta,   file_pheno      = file_pheno,   file_cov        = file_cov,   chr             = \"chr5\",   qtl_file        = qtl_file,   out_prefix      = out_prefix,   min_peaks       = 2 )  res_single_chr"},{"path":"https://liliw-w.github.io/cacti/index.html","id":"quick-start-genome-wide-wrapper-cacti_run_genome","dir":"","previous_headings":"","what":"Quick start: genome-wide wrapper (cacti_run_genome())","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"cacti_run_genome() loops chromosomes, runs cacti_run_chr() , combines results compute window-level FDR. toy data, chr5, usage pattern : res_genome list containing paths : file_peak_group – window-level group table file_peak_group_peaklevel – peak-level group assignment file_pheno_cov_residual – residualized phenotype matrix file_p_peak_group – window-level p-value files chromosome file_fdr_out – combined FDR-added window-level results.","code":"out_prefix <- tempfile(\"cacti_genome_\")  res_genome <- cacti_run_genome(   window_size     = \"50kb\",   file_pheno_meta = file_pheno_meta,   file_pheno      = file_pheno,   file_cov        = file_cov,   chrs            = \"chr5\",                 # toy example: one chromosome   qtl_files       = qtl_file,   out_prefix      = out_prefix,   file_fdr_out    = file.path(tempdir(), \"cacti_fdr_chr5.txt.gz\") )  res_genome"},{"path":"https://liliw-w.github.io/cacti/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"use CACTI method, please cite: Wang, L., & Liu, X. (2025). Improved chromatin QTL mapping CACTI. bioRxiv, 2025-06.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti.html","id":null,"dir":"Reference","previous_headings":"","what":"CACTI: Chromatin QTL Mapping with Peak Windows — cacti","title":"CACTI: Chromatin QTL Mapping with Peak Windows — cacti","text":"cacti package implements CACTI peak-window method chromatin QTL mapping. designed :","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"CACTI: Chromatin QTL Mapping with Peak Windows — cacti","text":"group nearby peaks non-overlapping genomic windows, residualize peak intensities respect covariates, run multi-peak association tests using principal-component omnibus (PCO) test, aggregate per-chromosome results compute window-level FDR. main user-facing functions : cacti_run_chr: run peak-window pipeline single chromosome. cacti_run_genome: run peak-window pipeline across multiple chromosomes add FDR. Lower-level building blocks: cacti_group_peak_window: group peaks non-overlapping windows. cacti_pheno_cov_residual: residualize phenotypes covariates. cacti_cal_p: run CACTI association tests peak windows. cacti_add_fdr: compute window-level FDR across chromosomes. small toy dataset Aracena et al. bundled inst/extdata/ can accessed using system.file testing examples. overview peak-window pipeline file formats, see package vignette: browseVignettes(\"cacti\")","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"CACTI: Chromatin QTL Mapping with Peak Windows — cacti","text":"Maintainer: Lili Wang liliw1@uchicago.edu","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_add_fdr.html","id":null,"dir":"Reference","previous_headings":"","what":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","title":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","text":"Reads per-chromosome CACTI window result files, computes per-window top-hit summaries (min p, Bonferroni, ACAT across SNPs window), assigns q-values ACAT top-hit p-values.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_add_fdr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","text":"","code":"cacti_add_fdr(file_all_pval, file_fdr_out)"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_add_fdr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","text":"file_all_pval character vector containing pvalue file paths. e.g., \"c(chr1.txt.gz, chr2.txt.gz, chr3.txt.gz)\" file_fdr_out Output filename combined results FDR.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_add_fdr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","text":"Invisibly returns combined results FDR.; writes file_fdr_out.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_add_fdr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","text":"Expected columns file: group : window / peak-group ID snp   : variant ID pval : p-value per (snp, group)","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_cal_p.html","id":null,"dir":"Reference","previous_headings":"","what":"Run CACTI association test for a single chromosome — cacti_cal_p","title":"Run CACTI association test for a single chromosome — cacti_cal_p","text":"Run CACTI association test single chromosome","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_cal_p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run CACTI association test for a single chromosome — cacti_cal_p","text":"","code":"cacti_cal_p(   file_qtl_cis_norm,   chr,   file_peak_group,   file_pheno_cov_residual,   file_p_peak_group,   dir_pco = system.file(\"pco\", package = \"cacti\"),   min_peaks = 2 )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_cal_p.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run CACTI association test for a single chromosome — cacti_cal_p","text":"file_qtl_cis_norm Path cis QTL summary stats. Must contain columns: phe_id, var_id, z. chr Chromosome label (e.g., \"chr21\"). Used subset peak groups. file_peak_group Path peak-window metadata (groups) file. Produced step_group_peak_window. file_pheno_cov_residual Path residualized phenotype matrix file. Produced step_pheno_cov_residual. file_p_peak_group Output path per-window pvalues. Columns: group, snp, pval. dir_pco Directory containing association test helpers: ModifiedPCOMerged_acat.R, liu.R, liumod.R, davies.R, qfc.. min_peaks Minimum number peaks required group run multivariate PCO test (>= min_peaks -> PCO; < min_peaks -> univariate p).","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_cal_p.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run CACTI association test for a single chromosome — cacti_cal_p","text":"Invisibly returns pvalue tibble; writes file_p_peak_group.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_group_peak_window.html","id":null,"dir":"Reference","previous_headings":"","what":"Group adjacent peaks by non-overlapping windows — cacti_group_peak_window","title":"Group adjacent peaks by non-overlapping windows — cacti_group_peak_window","text":"Group peaks non-overlapping genomic windows size window_size, using peak coordinates BED-like metadata table.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_group_peak_window.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group adjacent peaks by non-overlapping windows — cacti_group_peak_window","text":"","code":"cacti_group_peak_window(   window_size,   file_pheno_meta,   file_peak_group,   file_peak_group_peaklevel )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_group_peak_window.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group adjacent peaks by non-overlapping windows — cacti_group_peak_window","text":"window_size Character like \"50kb\" (kb units) numeric (bp). file_pheno_meta Path input phenotype meta table (header). Columns - phe_chr: chromosome, \"chr\" prefix (e.g. \"chr1\") phe_from: peak start (integer, < phe_to) phe_to: peak end (integer) phe_id: peak identifier (unique per row) file_peak_group Output path window-level table. Columns - group, group_chr, group_from, group_to, pid_group, n_pid_group file_peak_group_peaklevel Output path peak-level table. Columns - phe_id, phe_chr, phe_from, phe_to, group, n_pid_group","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_group_peak_window.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Group adjacent peaks by non-overlapping windows — cacti_group_peak_window","text":"Invisibly returns grouped window-level table; writes file_peak_group.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_pheno_cov_residual.html","id":null,"dir":"Reference","previous_headings":"","what":"Residualize peak intensity with covariates — cacti_pheno_cov_residual","title":"Residualize peak intensity with covariates — cacti_pheno_cov_residual","text":"Reads phenotype matrix (features x samples; first column = feature ID) covariate matrix (covariates x samples; first column = covariate ID)","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_pheno_cov_residual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Residualize peak intensity with covariates — cacti_pheno_cov_residual","text":"","code":"cacti_pheno_cov_residual(file_pheno, file_cov, file_pheno_cov_residual)"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_pheno_cov_residual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Residualize peak intensity with covariates — cacti_pheno_cov_residual","text":"file_pheno Path phenotype expression matrix. Rows = features; first column = feature ID; remaining columns = samples. file_cov Path covariate matrix. Rows = covariates; first column = covariate ID; remaining columns = samples. file_pheno_cov_residual Output filename. Rows = features; first column = feature ID; remaining columns = samples.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_pheno_cov_residual.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Residualize peak intensity with covariates — cacti_pheno_cov_residual","text":"Invisibly returns residual matrix (features x samples); writes file_pheno_cov_residual.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_chr.html","id":null,"dir":"Reference","previous_headings":"","what":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","title":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","text":"Steps: Group peaks non-overlapping windows. Residualize phenotype covariates. Run association test peak groups single chromosome.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_chr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","text":"","code":"cacti_run_chr(   window_size,   file_pheno_meta,   file_pheno,   file_cov,   chr,   qtl_file,   out_prefix,   dir_pco = system.file(\"pco\", package = \"cacti\"),   min_peaks = 2 )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_chr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","text":"window_size Character like \"50kb\" (kb units) numeric (bp). file_pheno_meta Path input phenotype meta table (header). Columns - phe_chr: chromosome, \"chr\" prefix (e.g. \"chr1\") phe_from: peak start (integer, < phe_to) phe_to: peak end (integer) phe_id: peak identifier (unique per row) file_pheno Path phenotype expression matrix. Rows = features; first column = feature ID; remaining columns = samples. file_cov Path covariate matrix. Rows = covariates; first column = covariate ID; remaining columns = samples. chr Chromosome label process (e.g., \"chr1\", \"chr21\"). qtl_file Path cis QTL summary stats file chromosome. Must contain columns: phe_id, var_id, z. out_prefix Output prefix used construct output filenames. dir_pco Directory containing association test helpers: ModifiedPCOMerged_acat.R, liu.R, liumod.R, davies.R, qfc.. min_peaks Minimum number peaks required window run multivariate PCO test (>= min_peaks -> PCO; < min_peaks -> univariate p).","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_chr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","text":"Invisibly returns named list output paths elements: file_peak_group Path window-level group. file_peak_group_peaklevel Path peak-level group. file_pheno_residual Path residualized phenotype matrix. file_p_peak_group Path per-window p-value file chromosome.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_chr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","text":"","code":"if (FALSE) { # \\dontrun{ # Example (chr5 only)  file_pheno_meta <- system.file(   \"extdata\", \"test_pheno_meta.bed\",   package = \"cacti\" )  file_pheno <- system.file(   \"extdata\", \"test_pheno.txt\",   package = \"cacti\" )  file_cov <- system.file(   \"extdata\", \"test_covariates.txt\",   package = \"cacti\" )  qtl_file <- system.file(   \"extdata\", \"test_qtl_sum_stats_chr5.txt.gz\",   package = \"cacti\" )  out_prefix <- tempfile(\"cacti_chr5_\")  res <- cacti_run_chr(   window_size = \"50kb\",   file_pheno_meta = file_pheno_meta,   file_pheno = file_pheno,   file_cov = file_cov,   chr = \"chr5\",   qtl_file = qtl_file,   out_prefix = out_prefix,   dir_pco = system.file(\"pco\", package = \"cacti\"),   min_peaks = 2 ) } # }"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_genome.html","id":null,"dir":"Reference","previous_headings":"","what":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","title":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","text":"function convenience wrapper runs CACTI peak-window pipeline across multiple chromosomes computes window-level FDR across peak windows chromosomes.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_genome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","text":"","code":"cacti_run_genome(   window_size,   file_pheno_meta,   file_pheno,   file_cov,   chrs,   qtl_files,   out_prefix,   dir_pco = system.file(\"pco\", package = \"cacti\"),   min_peaks = 2,   file_fdr_out = NULL )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_genome.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","text":"window_size Character like \"50kb\" (kb units) numeric (bp). file_pheno_meta Path input phenotype meta table (header). Columns - phe_chr: chromosome, \"chr\" prefix (e.g. \"chr1\") phe_from: peak start (integer, < phe_to) phe_to: peak end (integer) phe_id: peak identifier (unique per row) file_pheno Path phenotype expression matrix. Rows = features; first column = feature ID; remaining columns = samples. file_cov Path covariate matrix. Rows = covariates; first column = covariate ID; remaining columns = samples. chrs Character vector chromosome labels (e.g., paste0(\"chr\", 1:22)). qtl_files Either: character vector length chrs, giving cis-QTL file path chromosome order; single template string containing placeholder \"{chr}\", e.g., \"extdata/test_qtl_sum_stats_{chr}.txt.gz\". case, placeholder replaced element chrs. out_prefix Output prefix used construct output filenames. dir_pco Directory containing association test helpers: ModifiedPCOMerged_acat.R, liu.R, liumod.R, davies.R, qfc.. min_peaks Minimum number peaks required window run multivariate PCO test (>= min_peaks -> PCO; < min_peaks -> univariate p). file_fdr_out Optional output path FDR-added window-level file. NULL, default filename constructed out_prefix window_size.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_genome.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","text":"Invisibly returns named list output paths elements: file_peak_group Path window-level group. file_peak_group_peaklevel Path peak-level group. file_pheno_residual Path residualized phenotype matrix. file_p_peak_group Path per-window p-value file chromosome. file_fdr_out Path FDR-added window-level result file.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_genome.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","text":"chromosome chrs, calls cacti_run_chr() collects per-window p-value files. calls cacti_add_fdr() , aggregating chromosomes obtain q-values top-hit p-values window.","code":""},{"path":[]}]
